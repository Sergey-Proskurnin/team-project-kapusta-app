import React, { useState, useEffect } from 'react';
import ArrowForwardIosIcon from '@material-ui/icons/ArrowForwardIos';
import ArrowBackIosIcon from '@material-ui/icons/ArrowBackIos';
import Balance from '../Balance';
import s from './Report.module.css';
import { useSelector, useDispatch } from 'react-redux';
import transactionOp from '../../redux/transactions/transactions-operations';
import { getTransactionsPerMonth } from '../../redux/transactions/transactions-selectors';
import { result } from '../../data/db-transactions.json';
import { CurrentAmount, CurrentMonth } from './';
import categories from '../../data/categories';
const stat = ['Расходы', 'Доходы'];
const month = 2;

const Report = () => {
  const transaction = useSelector(getTransactionsPerMonth);
  const dispatch = useDispatch();

  const filteredByMonth = result.filter(
    transaction => transaction.month === month,
  );
  const getTransactionByType = type => {
    const filteredByType = filteredByMonth.filter(
      transaction => transaction.type === type,
    );
    return filteredByType;
  };

  const findeTotalSumByCategiry = (type, category) => {
    let totalExpense = 0;
    getTransactionByType(type)
      .filter(tr => tr.category === category)
      .map(el => {
        totalExpense += el.sum;
      });
    return totalExpense;
  };

  return (
    <div className={s.reportContainer}>
      <div className={`${s.navigation} ${s.section}`}>
        <Balance />
        <CurrentMonth />
      </div>
      <CurrentAmount />
      <div className={s.reportWrapper}>
        <div className={s.transactionWrapper}>
          <ArrowBackIosIcon style={{ color: '#FF751D' }} fontSize="small" />

          <h1 className={s.reportTitle}>Расходы</h1>
          <ArrowForwardIosIcon style={{ color: '#FF751D' }} fontSize="small" />
        </div>
        <ul className={s.reportList}>
          {categories.map(event => {
            console.log(event.name);
            let sum = findeTotalSumByCategiry('income', event.name);
            if (sum === 0) {
              return;
            }
            return (
              <li className={s.reportCard} key={event._id}>
                <p>{sum}</p>
                <svg
                  className={s.iconSvg}
                  xmlns="http://www.w3.org/2000/svg"
                  width="65"
                  height="56"
                >
                  <path d="M62.9703 44.5803L62.73 43.2832C62.5768 42.4543 61.8531 41.8528 61.0091 41.8528C60.9032 41.8528 60.7964 41.8625 60.6913 41.8818L55.799 42.7805L58.0145 41.2994C58.5952 40.9113 58.8886 40.2171 58.762 39.5284C58.7268 39.3398 58.6609 39.1588 58.5654 38.9893L57.8949 37.8021C57.6652 37.3942 57.2734 37.0911 56.8212 36.971C56.5997 36.9119 56.3682 36.8988 56.1423 36.9282C56.389 35.5666 56.5162 34.1759 56.5162 32.7602C56.5162 32.1321 56.1384 31.5915 55.5989 31.3515C56.3039 29.6746 56.352 27.7548 55.6551 25.9967C55.5986 25.8538 55.5147 25.7262 55.4061 25.6174C55.2983 25.5096 55.1722 25.4263 55.0291 25.3688C54.1939 25.0362 53.3162 24.8677 52.4203 24.8677C52.3058 24.8677 52.1917 24.8706 52.078 24.876C51.9502 22.3003 49.8184 20.2441 47.216 20.2441C46.8733 20.2441 46.5391 20.2805 46.2164 20.3484C46.4405 19.0072 46.3085 17.6041 45.7862 16.2868C45.7301 16.142 45.6458 16.012 45.5312 15.8956C45.421 15.7854 45.2917 15.7003 45.1482 15.6434C44.2486 15.2851 43.3031 15.1035 42.3379 15.1035C40.884 15.1035 39.4932 15.5122 38.2925 16.2721C37.8539 15.0014 37.1305 13.8085 36.1198 12.7955C35.8237 12.4989 35.43 12.3355 35.011 12.3355C34.592 12.3355 34.1983 12.4989 33.9019 12.7957L29.4337 17.2741C28.6068 16.5366 27.5187 16.0957 26.3377 16.0957C26.0697 16.0957 25.7991 16.1192 25.5335 16.1655C24.5709 16.3331 23.6851 16.8042 23.006 17.4942C22.1352 17.074 21.1376 16.9307 20.179 17.0975C19.9681 17.1342 19.7635 17.1859 19.5649 17.2489V13.7979C19.5649 11.4214 17.6548 9.48454 15.2921 9.44369V7.48651C16.0153 7.36137 16.5676 6.73101 16.5676 5.97255V1.53808C16.5676 0.690044 15.8777 0 15.0295 0H7.52478C6.67662 0 5.9867 0.690044 5.9867 1.53808V5.97255C5.9867 6.73101 6.53893 7.36137 7.2622 7.48651V9.44344C4.89946 9.48417 2.98954 11.421 2.98954 13.7977V40.732C1.14704 42.396 0 44.7178 0 47.2853C0 52.3358 4.43275 56.4448 9.88149 56.4448L46.8184 56.434C48.0791 56.4335 49.2648 55.8794 50.0713 54.914C50.8568 53.9742 51.1906 52.7534 50.9983 51.5495L58.3758 52.8754C58.4779 52.8937 58.5825 52.9031 58.6862 52.9031C59.0541 52.9031 59.4067 52.7901 59.7052 52.5767C60.089 52.3026 60.3487 51.8782 60.418 51.4127L60.6178 50.0719C60.6466 49.8798 60.6434 49.6864 60.6083 49.4968C60.4814 48.8112 59.9593 48.2672 59.2782 48.1111L56.6779 47.5146L61.5654 46.6167C62.0263 46.5321 62.4262 46.2733 62.6915 45.8881C62.9563 45.5038 63.0552 45.0394 62.9703 44.5803ZM52.4203 26.7131C52.9759 26.7131 53.5221 26.8011 54.0473 26.9745C54.5166 28.4035 54.3409 29.9449 53.606 31.2182H51.12L51.9133 30.4231C52.2733 30.0623 52.2726 29.478 51.9117 29.1179C51.5508 28.7579 50.9664 28.7585 50.6066 29.1194L50.1869 29.5401C49.9902 28.8923 49.6466 28.3122 49.1951 27.8364C50.111 27.1091 51.2354 26.7131 52.4203 26.7131ZM47.216 22.0895C48.8826 22.0895 50.2385 23.4494 50.2385 25.121C50.2385 25.152 50.237 25.1827 50.2361 25.2134C49.2633 25.5298 48.3667 26.0583 47.602 26.776C47.4803 26.7299 47.3569 26.687 47.2301 26.652C46.9602 25.1936 45.9774 24.0247 44.6791 23.4787C45.2179 22.644 46.1529 22.0895 47.216 22.0895ZM42.3378 16.9489C42.9646 16.9489 43.5806 17.0503 44.1741 17.2509C44.6512 18.6693 44.5537 20.193 43.9459 21.5128C43.4462 21.968 43.0408 22.5254 42.7637 23.1519C42.5989 23.1615 42.4341 23.1797 42.2714 23.208C41.5482 23.3339 40.8739 23.6477 40.3096 24.1027C40.1172 23.7508 39.8815 23.4261 39.6116 23.1337L41.7279 21.0126C42.0879 20.6519 42.0872 20.0675 41.7263 19.7076C41.3655 19.3476 40.7811 19.3482 40.4211 19.7091L38.1081 22.0274C37.6679 21.8193 37.1922 21.6746 36.6923 21.6069C36.9083 20.5057 37.4426 19.468 38.2693 18.6394C39.3569 17.5492 40.8018 16.9489 42.3378 16.9489ZM35.2663 31.2182H34.4664C34.3317 30.8754 33.9986 30.6324 33.6079 30.6324C33.2172 30.6324 32.8841 30.8755 32.7494 31.2182H31.8084C32.0269 30.8624 31.9827 30.3909 31.6742 30.083C31.3135 29.723 30.7291 29.7236 30.3691 30.0844L29.4993 30.956C29.4211 31.0343 29.3611 31.1235 29.3169 31.2182H27.4386C26.7352 30.1387 26.3058 28.8646 26.255 27.4939H40.8958C40.845 28.8646 40.4157 30.1387 39.7122 31.2182H37.7576C37.7136 31.1235 37.6533 31.0341 37.5753 30.9559L36.7056 30.0842C36.3454 29.7236 35.7613 29.7226 35.4006 30.0828C35.0918 30.3906 35.0477 30.8622 35.2663 31.2182ZM33.12 25.6482C33.4679 24.359 34.6438 23.4077 36.0375 23.4077C37.4312 23.4077 38.6072 24.3591 38.955 25.6482H33.12ZM35.0072 14.3007C35.885 15.2494 36.4654 16.3758 36.75 17.5597C36.2789 18.0717 35.8875 18.6375 35.5787 19.2395C35.4386 19.1536 35.2743 19.1033 35.098 19.1033H33.8683C33.3586 19.1033 32.9454 19.5165 32.9454 20.0262C32.9454 20.5358 33.3586 20.949 33.8683 20.949H34.947C34.8864 21.2038 34.8392 21.4618 34.805 21.7216C34.4386 21.8179 34.0886 21.9549 33.7611 22.1294C33.146 21.0679 32.1274 20.2768 30.9206 19.9595C30.9202 19.9569 30.9197 19.9543 30.9192 19.9517C30.8469 19.5341 30.7206 19.1379 30.5485 18.7696L35.0072 14.3007ZM18.3248 22.628C18.2707 22.4766 18.2297 22.3214 18.2027 22.1656C17.9381 20.6397 18.9667 19.1818 20.4953 18.9157C20.6565 18.8876 20.8203 18.8733 20.982 18.8733C21.59 18.8733 22.171 19.0673 22.6621 19.4341C22.8652 19.5859 23.1221 19.6473 23.3722 19.604C23.6222 19.5606 23.8433 19.4162 23.9836 19.2047C24.4168 18.5512 25.0797 18.1176 25.85 17.9835C26.0115 17.9553 26.1757 17.9412 26.3377 17.9412C27.705 17.9412 28.8671 18.9194 29.1006 20.2673C29.1274 20.4218 29.1412 20.5827 29.1414 20.7457C29.1423 21.2234 29.5076 21.6216 29.9836 21.6634C31.0153 21.7541 31.8936 22.4034 32.3008 23.3182C31.7557 23.9724 31.3778 24.7712 31.2343 25.6482H25.9714C25.317 25.6482 24.7556 26.0521 24.5214 26.6238C23.3636 25.8352 21.999 25.4103 20.5689 25.4103C19.673 25.4103 18.7953 25.579 17.9596 25.9117C17.8179 25.9683 17.6911 26.0519 17.5831 26.1599C17.4736 26.2694 17.3895 26.3978 17.3344 26.5385C17.122 27.0741 16.9804 27.6248 16.9039 28.1789C16.5731 27.8023 16.3401 27.3341 16.249 26.8087C16.032 25.5566 16.6874 24.3099 17.8425 23.7769C18.2766 23.5765 18.4859 23.078 18.3248 22.628ZM21.0759 30.9659L21.3276 31.2182H19.1112C18.6136 30.0638 18.538 28.7498 18.942 27.5174C19.4679 27.3437 20.0139 27.2559 20.5689 27.2559C21.9595 27.2559 23.2676 27.7994 24.2521 28.7861C24.383 28.9174 24.5049 29.0549 24.6195 29.1971C24.7759 29.9051 25.0162 30.5815 25.3258 31.2181H23.935L22.3825 29.6621C22.0224 29.3014 21.438 29.3004 21.0775 29.6606C20.7166 30.0207 20.7158 30.6051 21.0759 30.9659ZM17.1458 31.2182H13.8559C14.0026 30.3243 14.5403 29.5623 15.2867 29.1129C15.7285 29.7049 16.3052 30.1835 16.9697 30.5078C17.0167 30.7472 17.0744 30.9846 17.1458 31.2182ZM7.8324 1.8457H14.7219V5.66493H7.8324V1.8457ZM13.4464 7.51063V9.4416H9.10802V7.51063H13.4464ZM4.83535 17.5403H10.8281C11.3379 17.5403 11.7509 17.1271 11.7509 16.6174C11.7509 16.1078 11.3379 15.6946 10.8281 15.6946H4.83535V13.7977C4.83535 12.4134 5.95803 11.2873 7.33799 11.2873H15.2164C16.5965 11.2873 17.7192 12.4134 17.7192 13.7977V15.6946H15.996C15.4862 15.6946 15.0732 16.1078 15.0732 16.6174C15.0732 17.1271 15.4862 17.5403 15.996 17.5403H17.7192V18.3594C16.6618 19.396 16.1127 20.9163 16.3839 22.4801C16.3844 22.4832 16.385 22.4864 16.3855 22.4896C14.905 23.5053 14.1161 25.3111 14.4303 27.124C14.4486 27.2298 14.4716 27.3339 14.4967 27.4369C14.0357 27.6911 13.6216 28.0194 13.2667 28.4035H4.83535V17.5403ZM4.83523 30.2491H12.1951C12.0972 30.5602 12.028 30.8839 11.9943 31.2182H11.8388C10.9894 31.2182 10.2982 31.9099 10.2982 32.76C10.2982 34.2254 10.4345 35.6639 10.6984 37.0713C10.4332 37.05 10.1613 37.0386 9.88469 37.0386C8.76865 37.0386 7.70529 37.2156 6.89084 37.5373C5.645 38.0292 5.30059 38.7277 5.22541 39.2111C5.09338 39.2768 4.96369 39.3462 4.83523 39.4172V30.2491ZM16.5211 41.586C16.8534 41.8519 17.0566 42.0779 17.1743 42.241C17.1632 42.2411 17.1517 42.2412 17.14 42.2412C16.6177 42.2412 15.6792 42.0307 14.612 41.4399C14.2147 41.2198 13.8486 40.9711 13.5533 40.721C13.209 40.4292 12.7042 40.4295 12.3601 40.7211C12.0648 40.9715 11.6989 41.2201 11.3019 41.4397C10.2345 42.0307 9.29603 42.2412 8.77382 42.2412C8.76189 42.2412 8.75044 42.2411 8.73925 42.241C8.85688 42.0779 9.06003 41.8518 9.3925 41.5857C9.68301 41.3532 9.80544 40.9688 9.70295 40.6111C9.60033 40.2533 9.29296 39.992 8.9232 39.9487C8.02262 39.8432 7.45317 39.6139 7.18652 39.4471C7.5206 39.239 8.36519 38.8843 9.88505 38.8843C11.1438 38.8843 12.0638 39.1489 12.5051 39.3967C12.7858 39.5542 13.1279 39.5542 13.4086 39.3969C13.8501 39.1491 14.7702 38.8844 16.029 38.8844C17.549 38.8844 18.3935 39.2393 18.7274 39.4472C18.4609 39.6142 17.8913 39.8433 16.9905 39.9489C16.6207 39.9923 16.3132 40.2534 16.2107 40.6113C16.1079 40.9692 16.2303 41.3536 16.5211 41.586ZM14.675 52.8184L14.7068 52.9894C14.8165 53.5821 15.048 54.1261 15.3713 54.5991H9.88149C5.45059 54.5991 1.8457 51.3182 1.8457 47.2853C1.8457 44.5291 3.52996 42.1253 6.01008 40.8788C6.29493 41.0915 6.65004 41.2748 7.07135 41.4227C6.90426 41.708 6.78785 42.0149 6.76042 42.335C6.72399 42.7605 6.85418 43.1646 7.12734 43.4729C7.48823 43.8804 8.04219 44.087 8.77382 44.087C9.74884 44.087 11.0282 43.701 12.1959 43.0545C12.4647 42.9058 12.7189 42.7487 12.9569 42.5845C13.1948 42.7485 13.449 42.9057 13.7179 43.0547C14.8857 43.701 16.165 44.0869 17.14 44.087H17.1401C17.8715 44.087 18.4255 43.8804 18.7862 43.473C19.0595 43.1647 19.1898 42.7606 19.1533 42.335C19.1258 42.0149 19.0094 41.708 18.8423 41.4227C19.2637 41.2747 19.6189 41.0913 19.9037 40.8788C21.8706 41.8674 23.3362 43.584 23.8588 45.627L17.3318 48.1065C15.4213 48.8324 14.3039 50.814 14.675 52.8184ZM48.6548 53.7307C48.1997 54.2755 47.53 54.5881 46.8176 54.5883L45.8489 54.5887L45.2438 51.3212C45.1509 50.82 44.6697 50.4886 44.1682 50.5818C43.6672 50.6746 43.3361 51.156 43.4289 51.6572L43.972 54.5893L40.7966 54.5905L40.3875 52.381C40.2946 51.8798 39.8133 51.5488 39.312 51.6416C38.8109 51.7344 38.4798 52.2158 38.5726 52.717L38.9196 54.5913L31.5337 54.5941L30.9778 51.5932C30.8848 51.0921 30.4037 50.7611 29.9022 50.854C29.4011 50.9467 29.0701 51.4283 29.1629 51.9295L29.6566 54.5948L18.8724 54.599C18.8721 54.599 18.8719 54.599 18.8716 54.599C17.7184 54.599 16.7301 53.7808 16.5212 52.6529L16.4894 52.4819C16.2809 51.3553 16.9106 50.2408 17.9869 49.8318L21.614 48.4539L21.8842 49.9123C21.9665 50.3566 22.3543 50.6672 22.7904 50.6672C22.8463 50.6672 22.9029 50.662 22.9597 50.6516C23.4608 50.5587 23.7918 50.0772 23.6989 49.576L23.3675 47.7878L28.7514 45.7425C29.2278 45.5615 29.4674 45.0285 29.2864 44.552C29.1054 44.0755 28.5717 43.836 28.096 44.017L25.5907 44.9688C24.8879 42.4804 23.0823 40.4018 20.6879 39.2109C20.6127 38.7276 20.2683 38.0291 19.0226 37.5371C18.2082 37.2155 17.1448 37.0384 16.0288 37.0384C15.2607 37.0384 14.5272 37.1232 13.8798 37.2776V36.7202C13.8798 36.2106 13.4667 35.7974 12.9569 35.7974C12.7415 35.7974 12.5438 35.8717 12.3867 35.9955C12.2411 35.0329 12.1597 34.0552 12.1462 33.0637H42.2049C42.7147 33.0637 43.1278 32.6505 43.1278 32.1408C43.1278 31.6312 42.7147 31.218 42.2049 31.218H41.8273C42.415 30.0077 42.7469 28.6507 42.7469 27.2166C42.7469 26.4024 42.124 25.7317 41.3301 25.6555C41.6757 25.3296 42.1071 25.1098 42.588 25.026C42.7288 25.0016 42.8718 24.9891 43.0131 24.9891C44.2045 24.9891 45.217 25.8415 45.4204 27.0156C45.4439 27.1515 45.4559 27.2918 45.456 27.4327C45.4567 27.9106 45.8221 28.309 46.2982 28.3509C47.401 28.4477 48.3033 29.2772 48.4925 30.3679C48.5427 30.6579 48.5364 30.9441 48.4861 31.218H47.4959C46.9861 31.218 46.5731 31.6312 46.5731 32.1408C46.5731 32.6505 46.9861 33.0637 47.4959 33.0637H54.6685C54.6456 34.7565 54.4276 36.4102 54.0209 38.0146L49.0196 40.9669C48.7137 39.9023 48.0027 38.9993 47.0232 38.451C45.9245 37.8362 44.6188 37.7401 43.4413 38.1873L33.1409 42.1004C32.6644 42.2814 32.4249 42.8145 32.6059 43.2909C32.7869 43.7675 33.3205 44.0067 33.7963 43.8259L35.1532 43.3105L35.5746 45.5852C35.6569 46.0296 36.0447 46.3403 36.4809 46.3403C36.5367 46.3403 36.5933 46.3351 36.6501 46.3246C37.1511 46.2319 37.4823 45.7504 37.3895 45.2492L36.907 42.6443L44.0965 39.913C44.7627 39.6601 45.5007 39.7143 46.1217 40.0619C46.7416 40.4088 47.1711 41.0068 47.3 41.7023L49.167 51.7816C49.2957 52.4767 49.109 53.187 48.6548 53.7307ZM51.9475 46.5071C51.5169 46.5862 51.2013 46.9568 51.1916 47.3945C51.182 47.8322 51.4813 48.2163 51.9079 48.3142L58.7788 49.8901L58.6071 51.0417L50.6418 49.6103L49.3967 42.8878L56.3346 38.7923L56.9125 39.8157L51.0607 43.7275C50.6968 43.9707 50.5539 44.4361 50.7185 44.8417C50.883 45.2472 51.31 45.4815 51.7404 45.4024L60.9327 43.7138L61.1374 44.8188L51.9475 46.5071Z" />
                  <circle cx="420.9" cy="296.5" r="45.7" />
                  <path d="M520.5 78.1z" />
                </svg>

                {/* <img src={foodSvg} alt="React Logo" className={s.iconSvg} /> */}
                <p className={s.reportCardTitle}>{event.name}</p>
              </li>
            );
          })}
        </ul>
      </div>
    </div>
  );
};
export default Report;
